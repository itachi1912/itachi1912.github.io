<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=referrer content="no-referrer-when-downgrade">
<title>《高性能MySQL》读书笔记-3-Schema与数据类型优化2 | itachi's Blog</title>
<meta property="og:title" content="《高性能MySQL》读书笔记-3-Schema与数据类型优化2 - itachi's Blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-07-30T00:00:00+08:00">
<meta property="article:modified_time" content="2021-07-30T00:00:00+08:00">
<meta name=Keywords content="Blog">
<meta name=description content="《高性能MySQL》读书笔记-3-Schema与数据类型优化2">
<meta name=author content="阿林">
<meta property="og:url" content="https://itachi.xyz/post/high-performance-mysql-3.html">
<link rel="shortcut icon" href=/favicon.ico type=image/x-icon>
<link rel=stylesheet href=/css/normalize.css>
<link rel=stylesheet href=/css/style.css>
<script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js></script>
</head>
<body>
<header id=header class=clearfix>
<div class=container>
<div class=col-group>
<div class=site-name>
<a id=logo href=https://itachi.xyz>
itachi's Blog
</a>
<p class=description>昨夜梦 今辰你 明日思 | Blog about life and learning.</p>
</div>
<div>
<nav id=nav-menu class=clearfix>
<a class=current href=https://itachi.xyz>首页</a>
<a href=https://itachi.xyz/archives/ title=归档>归档</a>
<a href=https://itachi.xyz/about/ title=关于>关于</a>
<a href=https://itachi.xyz/tags/ title=标签>标签</a>
<a href=https://itachi.xyz/onenote/ title=一言>一言</a>
</nav>
</div>
</div>
</div>
</header>
<div id=body>
<div class=container>
<div class=col-group>
<div class=col-8 id=main>
<div class=res-cons>
<article class=post>
<header>
<h1 class=post-title>《高性能MySQL》读书笔记-3-Schema与数据类型优化2</h1>
</header>
<date class="post-meta meta-date">
2021年7月30日
</date>
<div class=post-meta>
<span>|</span>
<span class=meta-category><a href=/categories/technology>Technology</a></span>
</div>
<div class=post-meta>
<span id=busuanzi_container_page_pv>|<span id=busuanzi_value_page_pv></span><span>
阅读</span></span>
</div>
<div class=post-content>
<p>第四章 Schema与数据类型优化的第二篇笔记。</p>
<h2 id=2-mysql-schema设计陷阱>2. MySQL schema设计陷阱</h2>
<h4 id=21-太多的列>2.1 太多的列</h4>
<p>MySQL的存储引擎API工作时需要在核心服务层和存储引擎层之间通过行缓冲格式拷贝数据，然后在核心服务中将缓冲内容解码成各个列，这个转换过程代价很高。</p>
<h4 id=22-太多的关联>2.2 太多的关联</h4>
<p>所谓的”实体-属性-值“(EAV)设计模式是一个糟糕的设计模式。MySQL规定每个关联操作最多61张表，但是EAV需要很多自关联，实际上，太多关联时解析和优化的代价也会成为MySQL的性能问题。</p>
<h4 id=23-全能的枚举>2.3 全能的枚举</h4>
<p>注意防止使用过多枚举，一般情况下不要使用枚举。</p>
<h4 id=24-非此发明not-invent-here的null>2.4 非此发明(not invent here)的NULL</h4>
<p>一般情况字段值不推荐位null，即使需要事实上的空值时也不一定非要使用null，可以使用0或者没一个特殊值。但是确实需要null值时也不要害怕使用null。</p>
<h2 id=3-范式和反范式>3. 范式和反范式</h2>
<p>写密集的场景下，范式化设计schema会有不错的效果:</p>
<ul>
<li>范式化的更新操作通常比反范式要快</li>
<li>数据较好的范式化时，只有很少或者没有重复数据，修改的数据会更少</li>
<li>范式化的表通常更小，操作会更快</li>
<li>很少的冗余，意味着检索时更少需要distinct或者group by与语句</li>
</ul>
<p>范式化缺点：范式化设计的表通常需要很多关联，这不仅代价昂贵，也可能导致索引失效。范式可能会将同属一个索引的列分散到不同的表中。</p>
<p>反范式的schema数据都在一张表里，可以很好的避免关联。实际项目开发时经常混用范式和反范式。但这其中需要平衡更新和查询的频率来设计schema</p>
<h2 id=4-缓存表和汇总表>4. 缓存表和汇总表</h2>
</div>
<div class=post-archive>
<ul class=post-copyright>
<li><strong>原文作者：</strong><a rel=author href=https://itachi.xyz>阿林</a></li>
<li style=word-break:break-all><strong>原文链接：</strong><a href=https://itachi.xyz/post/high-performance-mysql-3.html>https://itachi.xyz/post/high-performance-mysql-3.html</a></li>
<li><strong>版权声明：</strong>本作品采用<a rel=license href=https://creativecommons.org/licenses/by-nc-nd/4.0/>知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
</ul>
</div>
<br>
<div class=post-archive>
</div>
<div class="post-meta meta-tags">
<ul class=clearfix>
<li><a href=/tags/%E9%AB%98%E6%80%A7%E8%83%BDmysql>高性能MySQL</a></li>
<li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0>读书笔记</a></li>
</ul>
</div>
</article>
<div id=gitalk-container></div>
<link rel=stylesheet href=https://unpkg.com/gitalk/dist/gitalk.css>
<script src=https://unpkg.com/gitalk/dist/gitalk.min.js></script>
<script>var gitalk=new Gitalk({id:decodeURI(window.location.pathname),clientID:'30ffb17e5ccaa5f1830e',clientSecret:'67ba9ccd9df5c8f402f46b2462f09d644219c04f',repo:'itachi1912.github.io',owner:'itachi1912',admin:['itachi1912'],labels:['gitment'],perPage:25});gitalk.render('gitalk-container')</script>
</div>
</div>
<div id=secondary>
<section class=widget>
<form id=search action=https://itachi.xyz/search/ method=get accept-charset=utf-8 target=_blank _lpchecked=1>
<input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://itachi.xyz>
<button type=submit class="submit icon-search"></button>
</form>
</section>
<section class=widget>
<h3 class=widget-title><a href=/categories/>分类</a></h3>
<ul class=widget-list>
<li><a href=https://itachi.xyz/categories/life/>Life (5)</a></li>
<li><a href=https://itachi.xyz/categories/technology/>Technology (6)</a></li>
</ul>
</section>
<section class=widget>
<h3 class=widget-title>最近文章</h3>
<ul class=widget-list>
<li>
<a href=https://itachi.xyz/post/high-performance-mysql-3.html title=《高性能MySQL》读书笔记-3-Schema与数据类型优化2>《高性能MySQL》读书笔记-3-Schema与数据类型优化2</a>
</li>
<li>
<a href=https://itachi.xyz/post/high-performance-mysql-2.html title=《高性能MySQL》读书笔记-2-Schema与数据类型优化1>《高性能MySQL》读书笔记-2-Schema与数据类型优化1</a>
</li>
<li>
<a href=https://itachi.xyz/post/high-performance-mysql-1.html title=《高性能MySQL》读书笔记-1-MySQL架构与历史>《高性能MySQL》读书笔记-1-MySQL架构与历史</a>
</li>
<li>
<a href=https://itachi.xyz/post/backtrace-theory.html title=回溯算法(理论篇)>回溯算法(理论篇)</a>
</li>
<li>
<a href=https://itachi.xyz/post/good-habits.html title=优秀的人有优秀的习惯>优秀的人有优秀的习惯</a>
</li>
<li>
<a href=https://itachi.xyz/post/configure-two-github-accounts.html title=配置多个github账号>配置多个github账号</a>
</li>
<li>
<a href=https://itachi.xyz/post/donation.html title=众志成城，抗洪救灾！>众志成城，抗洪救灾！</a>
</li>
<li>
<a href=https://itachi.xyz/post/book-review-1.html title=读《定投改变命运》的一点感悟>读《定投改变命运》的一点感悟</a>
</li>
<li>
<a href=https://itachi.xyz/post/blog-test.html title="Hugo 博客内容测试">Hugo 博客内容测试</a>
</li>
<li>
<a href=https://itachi.xyz/post/sleep-is-your-super-power.html title=睡眠是你的超能力>睡眠是你的超能力</a>
</li>
</ul>
</section>
<section class=widget>
<h3 class=widget-title>友情链接</h3>
<ul class=widget-list>
<li>
<a target=_blank href=https://www.acdiao.com title=AC的简单博客>AC的简单博客</a>
</li>
<li>
<a target=_blank href=https://img.tujidu.com title=AC大佬的图床>AC大佬的图床</a>
</li>
<li>
<a target=_blank href=https://blog.cetcweb.cn/ title=记录实验过程>记录实验过程</a>
</li>
<li>
<a target=_blank href=https://qitablog.com/ title=奇它博客>奇它博客</a>
</li>
<li>
<a target=_blank href=http://laihongquan.com/ title=Ezio>Ezio</a>
</li>
</ul>
</section>
<section class=widget>
<h3 class=widget-title>其它</h3>
<ul class=widget-list>
<li><a href=https://itachi.xyz/index.xml>文章 RSS</a></li>
</ul>
</section>
</div>
</div>
<footer id=footer>
<div style=font-size:.7em>
Powered by <a href=https://gohugo.io/ target=_black rel=nofollow>Hugo</a>
and
Theme Based On <a href=https://www.flysnow.org/ target=_black>飞雪无情</a>
</div>
<br>
<div style=font-size:.7em>
&copy; 2021 Made with <span style=color:red>❤</span> By 阿林</a>
</div>
</footer>
<script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:!0}}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<a id=rocket href=#top></a>
<script type=text/javascript src="/js/totop.js?v=0.0.0" async></script>
<script type=text/javascript src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async></script>
</div>
</div>
</body>
</html>